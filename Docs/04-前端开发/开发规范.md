# 前端开发规范

## 1. 代码风格规范

### 1.1 命名规范

#### 文件命名

- **组件文件**：使用PascalCase，如 `UserProfile.vue`
- **工具文件**：使用camelCase，如 `formatDate.js`
- **样式文件**：使用kebab-case，如 `user-profile.css`
- **目录名**：使用kebab-case，如 `user-profile/`

#### 变量命名

```javascript
// 常量：使用UPPER_SNAKE_CASE
const MAX_RETRY_COUNT = 3;
const API_BASE_URL = 'https://api.example.com';

// 变量：使用camelCase
const userName = 'John';
const isLoggedIn = true;

// 布尔值：以is/has/can开头
const isActive = true;
const hasPermission = false;
const canEdit = true;

// 函数：使用camelCase，动词开头
function getUserData() { }
function handleSubmit() { }
function renderList() { }

// 类：使用PascalCase
class UserService { }
class HttpClient { }
```

#### 组件命名

```vue
<!-- 组件名使用PascalCase -->
<template>
  <UserProfile />
  <SearchInput />
  <BaseButton />
</template>

<script setup>
import UserProfile from './UserProfile.vue';
import SearchInput from './SearchInput.vue';
import BaseButton from '@/components/_base/BaseButton.vue';
</script>
```

### 1.2 代码格式化

使用Prettier进行代码格式化，配置文件 `.prettierrc.js`：

```javascript
module.exports = {
  semi: false,           // 不使用分号
  singleQuote: true,      // 使用单引号
  tabWidth: 2,           // 缩进2个空格
  trailingComma: 'es5',  // ES5尾随逗号
  printWidth: 100,        // 每行最大100字符
  arrowParens: 'always',  // 箭头函数参数使用括号
  endOfLine: 'lf'        // 使用LF换行符
};
```

### 1.3 ESLint规则

使用ESLint进行代码检查，配置文件 `.eslintrc.js`：

```javascript
module.exports = {
  root: true,
  env: {
    node: true,
    browser: true,
    es2021: true
  },
  extends: [
    'plugin:vue/vue3-recommended',
    'eslint:recommended'
  ],
  parserOptions: {
    ecmaVersion: 'latest',
    sourceType: 'module'
  },
  rules: {
    'vue/multi-word-component-names': 'off',
    'no-console': process.env.NODE_ENV === 'production' ? 'warn' : 'off',
    'no-debugger': process.env.NODE_ENV === 'production' ? 'warn' : 'off'
  }
};
```

## 2. Vue 3 开发规范

### 2.1 组件开发

#### 组件结构

```vue
<template>
  <!-- 模板内容 -->
</template>

<script setup>
import { ref, computed, onMounted } from 'vue';

// Props定义
const props = defineProps({
  title: {
    type: String,
    required: true
  },
  count: {
    type: Number,
    default: 0
  }
});

// Emits定义
const emit = defineEmits(['update', 'delete']);

// 响应式数据
const localCount = ref(props.count);

// 计算属性
const displayCount = computed(() => {
  return localCount.value > 0 ? localCount.value : '无';
});

// 方法
const handleUpdate = () => {
  localCount.value++;
  emit('update', localCount.value);
};

// 生命周期
onMounted(() => {
  console.log('组件已挂载');
});
</script>

<style scoped>
/* 组件样式 */
</style>
```

#### Props定义规范

```javascript
const props = defineProps({
  // 必填属性
  userId: {
    type: Number,
    required: true
  },
  
  // 可选属性带默认值
  userName: {
    type: String,
    default: '匿名用户'
  },
  
  // 复杂类型
  userInfo: {
    type: Object,
    default: () => ({})
  },
  
  // 数组类型
  tags: {
    type: Array,
    default: () => []
  },
  
  // 自定义验证
  age: {
    type: Number,
    validator: (value) => {
      return value >= 0 && value <= 150;
    }
  }
});
```

### 2.2 组合式API使用

#### 响应式数据

```javascript
import { ref, reactive, computed } from 'vue';

// ref：用于基本类型
const count = ref(0);
const message = ref('Hello');

// reactive：用于对象类型
const user = reactive({
  name: 'John',
  age: 30,
  email: 'john@example.com'
});

// computed：计算属性
const fullName = computed(() => {
  return `${user.name} (${user.age}岁)`;
});

// 修改响应式数据
count.value++;
user.name = 'Jane';
```

#### 生命周期钩子

```javascript
import { onMounted, onUpdated, onUnmounted } from 'vue';

onMounted(() => {
  // 组件挂载后执行
  console.log('组件已挂载');
});

onUpdated(() => {
  // 组件更新后执行
  console.log('组件已更新');
});

onUnmounted(() => {
  // 组件卸载前执行
  console.log('组件即将卸载');
});
```

#### 侦听器

```javascript
import { ref, watch, watchEffect } from 'vue';

const count = ref(0);
const user = ref({ name: 'John' });

// watch：侦听特定数据
watch(count, (newValue, oldValue) => {
  console.log(`count从${oldValue}变为${newValue}`);
});

// 深度侦听对象
watch(user, (newValue) => {
  console.log('user对象变化', newValue);
}, { deep: true });

// watchEffect：自动追踪依赖
watchEffect(() => {
  console.log(`当前count值：${count.value}`);
});
```

### 2.3 路由开发

#### 路由配置

```javascript
import { createRouter, createWebHistory } from 'vue-router';

const routes = [
  {
    path: '/',
    name: 'home',
    component: () => import('@/modules/blog/components/HomePage.vue'),
    meta: {
      title: '首页',
      requiresAuth: false
    }
  },
  {
    path: '/profile',
    name: 'profile',
    component: () => import('@/modules/profile/components/ProfilePage.vue'),
    meta: {
      title: '个人中心',
      requiresAuth: true
    }
  }
];

const router = createRouter({
  history: createWebHistory(),
  routes
});

export default router;
```

#### 路由守卫

```javascript
router.beforeEach((to, from, next) => {
  // 设置页面标题
  document.title = to.meta.title || 'MyBlog';
  
  // 检查认证状态
  if (to.meta.requiresAuth && !isAuthenticated()) {
    next('/login');
  } else {
    next();
  }
});
```

## 3. 样式开发规范

### 3.1 CSS变量使用

```css
/* 使用CSS变量定义主题色 */
:root {
  --primary-color: #C62828;
  --secondary-color: #E53935;
  --text-color: #263238;
  --background-color: #FBE9E7;
  --border-radius: 16px;
  --spacing-md: 16px;
}

/* 使用CSS变量 */
.button {
  background-color: var(--primary-color);
  color: white;
  border-radius: var(--border-radius);
  padding: var(--spacing-md);
}
```

### 3.2 BEM命名规范

```css
/* Block */
.card { }

/* Element */
.card__header { }
.card__body { }
.card__footer { }

/* Modifier */
.card--primary { }
.card--large { }

/* 组合使用 */
.card--primary .card__header { }
```

### 3.3 响应式设计

```css
/* 使用媒体查询实现响应式 */
.container {
  padding: 16px;
}

@media (min-width: 768px) {
  .container {
    padding: 24px;
  }
}

@media (min-width: 1024px) {
  .container {
    padding: 32px;
  }
}
```

## 4. API调用规范

### 4.1 HTTP客户端配置

```javascript
import axios from 'axios';

const http = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL || 'http://localhost:8000',
  timeout: 10000,
  headers: {
    'Content-Type': 'application/json'
  }
});

// 请求拦截器
http.interceptors.request.use(
  config => {
    // 添加认证token
    const token = localStorage.getItem('token');
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  error => {
    return Promise.reject(error);
  }
);

// 响应拦截器
http.interceptors.response.use(
  response => {
    return response.data;
  },
  error => {
    // 统一错误处理
    if (error.response) {
      switch (error.response.status) {
        case 401:
          // 未授权，跳转登录
          window.location.href = '/login';
          break;
        case 403:
          // 禁止访问
          console.error('权限不足');
          break;
        case 404:
          // 资源不存在
          console.error('资源不存在');
          break;
        case 500:
          // 服务器错误
          console.error('服务器错误');
          break;
      }
    }
    return Promise.reject(error);
  }
);

export default http;
```

### 4.2 API服务封装

```javascript
import http from '@/utils/http';

export const userService = {
  // 获取用户信息
  getUser(userId) {
    return http.get(`/api/user-server/users/${userId}`);
  },
  
  // 更新用户信息
  updateUser(userId, data) {
    return http.put(`/api/user-server/users/${userId}`, data);
  },
  
  // 删除用户
  deleteUser(userId) {
    return http.delete(`/api/user-server/users/${userId}`);
  }
};
```

## 5. 状态管理规范

### 5.1 模块化状态

```javascript
import { reactive } from 'vue';

export const useUserStore = () => {
  const state = reactive({
    user: null,
    isLoggedIn: false,
    permissions: []
  });
  
  const actions = {
    setUser(user) {
      state.user = user;
      state.isLoggedIn = !!user;
    },
    
    setPermissions(permissions) {
      state.permissions = permissions;
    },
    
    clearUser() {
      state.user = null;
      state.isLoggedIn = false;
      state.permissions = [];
    }
  };
  
  return {
    ...toRefs(state),
    ...actions
  };
};
```

## 6. 性能优化规范

### 6.1 组件懒加载

```javascript
const routes = [
  {
    path: '/profile',
    component: () => import('@/modules/profile/components/ProfilePage.vue')
  }
];
```

### 6.2 图片优化

```vue
<template>
  <!-- 使用懒加载 -->
  <img 
    v-lazy="imageUrl" 
    alt="描述文字"
    loading="lazy"
  />
</template>
```

### 6.3 列表虚拟化

```vue
<template>
  <!-- 使用虚拟滚动处理长列表 -->
  <VirtualList 
    :items="largeList" 
    :item-height="50"
  />
</template>
```

## 7. 测试规范

### 7.1 单元测试

```javascript
import { mount } from '@vue/test-utils';
import { expect } from 'vitest';
import Button from './Button.vue';

describe('Button组件', () => {
  it('应该正确渲染文本', () => {
    const wrapper = mount(Button, {
      props: { text: '点击我' }
    });
    
    expect(wrapper.text()).toBe('点击我');
  });
  
  it('应该触发点击事件', async () => {
    const wrapper = mount(Button);
    await wrapper.trigger('click');
    
    expect(wrapper.emitted().click).toBeTruthy();
  });
});
```

## 8. 注释规范

### 8.1 文件注释

```javascript
/**
 * 用户服务
 * 提供用户相关的API调用
 * @author YourName
 * @date 2026-01-29
 */

import http from '@/utils/http';
```

### 8.2 函数注释

```javascript
/**
 * 格式化日期
 * @param {Date|string} date - 日期对象或日期字符串
 * @param {string} format - 格式化模板，默认为'YYYY-MM-DD'
 * @returns {string} 格式化后的日期字符串
 * @example
 * formatDate(new Date(), 'YYYY-MM-DD HH:mm:ss')
 * // 返回: '2026-01-29 14:30:00'
 */
function formatDate(date, format = 'YYYY-MM-DD') {
  // 实现代码
}
```

### 8.3 组件注释

```vue
<!--
  用户头像组件
  Props:
    - userId: 用户ID（必填）
    - size: 头像大小，默认为40px
    - showBorder: 是否显示边框，默认为false
-->
<template>
  <div class="user-avatar" :style="{ width: size + 'px', height: size + 'px' }">
    <img :src="avatarUrl" :alt="userName" />
  </div>
</template>
```

## 9. Git提交规范

### 9.1 提交信息格式

```
<type>(<scope>): <subject>

<body>

<footer>
```

### 9.2 Type类型

- `feat`：新功能
- `fix`：修复bug
- `docs`：文档更新
- `style`：代码格式调整
- `refactor`：重构
- `perf`：性能优化
- `test`：测试相关
- `chore`：构建过程或辅助工具的变动

### 9.3 示例

```
feat(user): 添加用户头像上传功能

- 实现头像上传API
- 添加头像预览组件
- 更新用户信息显示

Closes #123
```

---

**文档版本**：v1.0.0  
**最后更新**：2026-01-29  
**维护者**：MyBlog开发团队