# 模块接口规范

## 1. 模块间通信方式

### 1.1 事件总线
- 使用Vue的事件系统进行模块间通信
- 事件命名规范：`module:{moduleName}:{eventName}`
- 示例：`module:auth:userLoggedIn`

### 1.2 状态管理
- 使用Pinia进行全局状态管理
- 模块可以订阅和修改相关状态
- 状态命名规范：`{moduleName}/{stateName}`

### 1.3 直接导入
- 对于紧密相关的模块，可以直接导入对方的服务或组件
- 应避免循环依赖

## 2. 数据传递格式

### 2.1 Props传递
- 使用kebab-case格式命名props
- 为props提供默认值和类型定义
- 复杂对象应使用TypeScript接口定义

### 2.2 事件传递
- 事件名称使用kebab-case格式
- 事件数据应封装在一个对象中
- 示例：`{ detail: { userId: 1, name: 'John' } }`

### 2.3 API响应
- 统一的API响应格式：`{ success: boolean, data: any, error: string }`
- 错误处理应遵循统一的模式

## 3. 组件接口规范

### 3.1 命名规范
- 组件名称使用PascalCase格式
- 基础组件：`Base{ComponentName}`
- 布局组件：`Layout{ComponentName}`
- 功能组件：`{Feature}{ComponentName}`
- 通用组件：`Common{ComponentName}`

### 3.2 Props定义
- 每个组件应明确定义props
- 使用Vue 3的defineProps语法
- 为props提供类型和默认值

### 3.3 事件定义
- 使用Vue 3的defineEmits语法
- 明确定义事件名称和参数

### 3.4 插槽规范
- 命名插槽使用kebab-case格式
- 为插槽提供默认内容
- 文档化插槽的用途和参数

## 4. 服务接口规范

### 4.1 命名规范
- 服务名称使用camelCase格式
- 服务文件命名：`{serviceName}Service.js`

### 4.2 方法定义
- 方法名称使用camelCase格式
- 异步方法应返回Promise
- 方法参数应明确定义类型

### 4.3 错误处理
- 服务方法应统一处理错误
- 错误应包含错误代码和错误消息
- 示例：`{ code: 'AUTH_ERROR', message: 'Authentication failed' }`

## 5. 状态管理规范

### 5.1 Store命名
- Store名称使用camelCase格式
- Store文件命名：`{storeName}Store.js`

### 5.2 状态定义
- 状态名称使用camelCase格式
- 复杂状态应使用TypeScript接口定义
- 状态应尽可能扁平化

### 5.3 Actions和Mutations
- Actions名称使用camelCase格式
- Mutations名称使用UPPER_SNAKE_CASE格式
- Actions可以是异步的，Mutations必须是同步的

## 6. 路由规范

### 6.1 路由命名
- 路由名称使用kebab-case格式
- 路由路径使用kebab-case格式

### 6.2 路由嵌套
- 合理使用路由嵌套
- 避免过深的路由嵌套

### 6.3 路由守卫
- 实现全局和局部路由守卫
- 路由守卫应处理权限验证和数据预加载

## 7. 模块集成规范

### 7.1 模块注册
- 模块应通过统一的注册机制集成到应用中
- 模块注册应包含路由、状态管理和服务

### 7.2 依赖管理
- 模块间依赖应明确定义
- 避免隐式依赖

### 7.3 版本管理
- 每个模块应包含版本信息
- 模块版本应遵循语义化版本规范

## 8. 开发规范

### 8.1 代码风格
- 遵循ESLint和Prettier规范
- 使用4个空格进行缩进
- 代码行长度不超过120个字符

### 8.2 文档规范
- 模块应包含README.md文件
- 组件和服务应包含JSDoc注释
- 复杂逻辑应包含内联注释

### 8.3 测试规范
- 每个模块应包含单元测试
- 测试覆盖率应不低于80%
- 测试文件命名：`{componentName}.spec.js`

## 9. 示例模块接口

### 9.1 认证模块
- 事件：`module:auth:userLoggedIn`, `module:auth:userLoggedOut`
- 状态：`auth/user`, `auth/isAuthenticated`
- 服务：`authService.login()`, `authService.logout()`

### 9.2 博客模块
- 事件：`module:blog:postCreated`, `module:blog:postUpdated`
- 状态：`blog/posts`, `blog/currentPost`
- 服务：`blogService.getPosts()`, `blogService.createPost()`

### 9.3 仪表盘模块
- 事件：`module:dashboard:widgetAdded`, `module:dashboard:widgetRemoved`
- 状态：`dashboard/widgets`, `dashboard/layout`
- 服务：`dashboardService.getWidgets()`, `dashboardService.updateLayout()`

### 9.4 设置模块
- 事件：`module:settings:updated`, `module:settings:themeChanged`
- 状态：`settings/userSettings`, `settings/theme`
- 服务：`settingsService.updateSettings()`, `settingsService.getTheme()`

## 10. 最佳实践

- 保持模块的高内聚低耦合
- 优先使用事件通信而非直接依赖
- 明确定义模块的边界和责任
- 文档化模块的接口和用法
- 定期审查模块间的依赖关系
- 遵循统一的编码和命名规范

通过遵循这些接口规范，可以确保模块间的通信更加清晰和可靠，提高代码的可维护性和可扩展性。